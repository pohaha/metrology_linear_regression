# Предсказывание рейтингов кулинарных рецептов 
## Обзор данных
Необходимо посмотреть на данные и провести обзорный анализ данных.

* Данные в датасэте () представленны в виде:
![basic view of data](/basic_data.png)
* Судя по виду данных: 
![data structure](/data_structure.png) 
* Наиболее важными являются:
1) Название рецепта
2) Рейтинг рецепта (от 1 до 5)
3) Количество калорий в блюде
4) Количество жиров и протеинов в грамах
5) Количество соды (в милиграмах)

Так же в данных присутствует множество позиций показывающих наличие или отсутствие ингредиента в рецепта (0,1) Данные колонки могут добавить огромное количество нулей, и некоторое количество единиц в общую схему весов элементов. Так же - они не будут особенно полезными, хотя это надо проверить. Зададим сумму значений элементов колонки больше 5000(число взято для примера) и выведем только данные чья сумма значений превышает это число:

![Наиболее важные элементы датасэта](/most_important%20features.png)

Отбросим данные не вошедшие в выборку

## Предварительная обработка данных
На втором этапе необзходимо провести обработку данных. Необходимо заполнить пустые ячейки в случае если такие присутствуют и выявить зависимые элементы датасэта (dependant features) а так же основные независимые (предсказывающие) элементы.

Покеажем первые несколько строк с исключительно наиболее значимыми элементами датасэта:

![первые элементы с самым значимым содержимым](/first_important_rows.png)

1) Проведем работу с недостающими данными:

![Количество рядов с недостяющими данными](/missing_data.png)

В колонках Калории, Протеин, Жиры, Сода - присутствует большое количество недостающих рядов данных и Чиста надостающих рядов - в общем-то довольно схожи. Узнаем, у какого количества рядов нет всех четырех признаков:

![количество рядов в которых отсутствуют все 4 признака](/rows_with_all_features_missing.png)

Как можно заметить в основном большинстве рядов в которых отсутствует хотябы один из признаков - отсутствуют так же и все остальные. Количество элементов в датасэте - позволяет попросту удвлить все эти ряды из него - убрав недостающие данные.

После удаления строк - не должно остаться строчек без данных в них:

![Отсутствие строк с недостающими данными](/no_missing_data.png)

2) Проведем анализ

Отделим зависимый признак от независимых, И посмотрим какие признаки наиболее сильно влияют на независимый прищзнак (в нашем случае - рейтинг рецепта)
Так же - создадим некоторые признаки путем комбинации нескольких столбцов (например протеин\калории, жиры\калории).

![Зависимость рейтинга от других признаков](/feature_dependancies.png)

Как можно наблюдать из графа зависимости признаков - признаки kosher, penut free, soy free и vegeterian - почти не влияют на итоговый рейтинг рецепта, так что мы можем от них избавиться, дабы делать более точные предсказания основываясь на датасэте

## Создание модели обучения

Разделим данные на тренировочные и тестовые, после чего внесем их в модель линейной регрессии, после чего - измерим насколько хорошо данная млодель может предсказывать рейтинги рецептов.
Итоговый результат (оценка точности получившейся модели) представлен в виде среднего квадратичного отклонения (MSE) его можно видеть в выводе программы:
 ![Средняя ошибка получившейся модели](/mean_square_error.png)